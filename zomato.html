<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Document</title>
</head>
<body>
    
    <form id="form">
        <label>Please enter the Name of your city</label>
        <input type="text" id="cityName"/>
        <select name="categoryOp" id="category">
            <option value="">Select one</option>
            <option value="chinese">Chinese Food</option>
            <option value="latin">Latin Food</option>
            <option value="italian">Italian Food</option>
        </select>
        <button id="submit" type="submit">submit</button>
    </form>
    <div id="container"></div>
    
    <!--randojs for randomizations-->
    <script src="https://randojs.com/2.0.0.js"></script>
    <script>
        //chinese: 25
        //Latin: 55
        //Italian: 136

        var submitBtn = document.getElementById("form");
        var cityEl = document.getElementById("cityName");
        var categoryEl = document.getElementById("category");
        var containerEl = document.getElementById("container");

        var getCity = function(event){
            event.preventDefault();
            var city = cityEl.value;
            var category = categoryEl.value;
            cityEl.value = "";

            var url = "https://cors-anywhere.herokuapp.com/https://api.yelp.com/v3/businesses/search?term=" + category + "&location=" + city;
            fetch(url, {
                headers: {
                    mode: 'no-cors',
                    'Content-Type': 'application/json',
                    Authorization: "Bearer quJaFb-FDw5HkLiT6j-2CqDL9sFMrO7tynIDs8bCt1-rK52VQ_6wBzuYZdIVEk2NqYZ7ipd5grBnQIH6PIHpmYSMsAaq7xVFrZJtQDQu9rspQ2QWj_Lbwc15GZRqX3Yx"
                }
            }
            ).then(function(response){
                response.json().then(function(data){
                    shuffle(data.businesses);
                });
            });
        }


        var shuffle = function(restaurants) {
            var currentIndex = restaurants.length, temporaryValue, randomIndex;

            // While there remain elements to shuffle
            while (0 !== currentIndex) {
            
              // Pick a remaining element
              randomIndex = Math.floor(Math.random() * currentIndex);
              currentIndex -= 1;
            
              // And swap it with the current element
              temporaryValue = restaurants[currentIndex];
              restaurants[currentIndex] = restaurants[randomIndex];
              restaurants[randomIndex] = temporaryValue;
            }
            display(restaurants);
            
        }

        var display = function(data){
            console.log(data)

            var title = document.createElement("h3");
            title.innerHTML = data[0].name;
            containerEl.appendChild(title);
            
            var img = document.createElement("img");
            img.setAttribute("src", data[0].image_url);
            img.setAttribute("alt", data[0].name);
            containerEl.appendChild(img);
            
            var address = document.createElement("div");
            address.innerHTML = data[0].location.address1 + ' ' + data[0].location.city + ', ' + data[0].location.state;
            containerEl.appendChild(address);

        }
       
        submitBtn.addEventListener("submit", getCity);
    </script>
</body>
</html>